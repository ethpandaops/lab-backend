# Lab Backend Configuration
# This config uses external URLs that work for local development
# In Kubernetes, these can be overridden via ConfigMap to use internal DNS

server:
  # HTTP server settings
  port: 8080
  host: "0.0.0.0"

  # Timeouts
  read_timeout: 30s
  write_timeout: 30s
  shutdown_timeout: 10s

  # Logging
  log_level: "info"  # trace, debug, info, warn, error, fatal, panic

# Redis config
redis:
  address: "localhost:6379"
  password: ""
  db: 0
  dial_timeout: 5s
  read_timeout: 3s
  write_timeout: 3s
  pool_size: 10

# Leader election config
leader:
  lock_key: "lab:leader:lock"
  lock_ttl: 30s        # Leader lock expires after 30s
  renew_interval: 10s  # Leader renews lock every 10s
  retry_interval: 5s   # Followers retry acquiring leadership every 5s

# Cartographoor integration
# Dynamically discover and manage networks from ethPandaOps cartographoor
cartographoor:
  source_url: "https://ethpandaops-platform-production-cartographoor.ams3.cdn.digitaloceanspaces.com/networks.json"
  refresh_interval: 5m   # How often the leader refreshes network data from upstream
  request_timeout: 30s   # HTTP request timeout for fetching data
  networks_ttl: 0s       # Redis TTL for networks data (0s = no expiration)

# Bounds service configuration
# Fetches and caches min/max position bounds for incremental CBT tables
bounds:
  refresh_interval: 10s       # How often the leader refreshes bounds data from upstream (minimum 5s)
  request_timeout: 30s        # HTTP request timeout for fetching bounds (minimum 5s)
  bounds_ttl: 0s              # Redis TTL for bounds data (0s = no expiration)

# Network configuration (optional overrides and additions)
# Cartographoor provides base networks - use this section to:
# 1. Disable specific cartographoor networks
# 2. Override metadata/URLs for cartographoor networks
# 3. Add custom/local networks not in cartographoor
#
# All fields except 'name' are optional. Cartographoor is the source of truth,
# and config.yaml values override cartographoor when explicitly set.
networks:
  # Example: Disable a cartographoor network
  # - name: sepolia
  #   enabled: false

  # Example: Override URL and metadata for a cartographoor network
  # - name: mainnet
  #   enabled: true
  #   target_url: "https://my-custom-cbt.example.com/api/v1"
  #   display_name: "Ethereum Mainnet"
  #   chain_id: 1
  #   genesis_time: 1606824023
  #   genesis_delay: 0

  # Example: Add a custom network not in cartographoor
  # - name: my-local-devnet
  #   enabled: true
  #   target_url: "http://localhost:8080/api/v1"
  #   display_name: "My Local Devnet"
  #   chain_id: 32382
  #   genesis_time: 1234567890
  #   genesis_delay: 10

  # Note: Networks from cartographoor are automatically added with all metadata.
  # Only add entries here to disable, override, or add custom networks.

# Experiment feature flags
# Controls which experiments are available per network
# By default, experiments are enabled for all networks unless overridden
experiments:
  live-slots:
    enabled: true
    networks: ["mainnet"]  # Only enabled for mainnet

  block-production:
    enabled: false         # Disabled for all networks

  attestation-performance:
    enabled: true          # Enabled for all networks (no networks specified = default)
